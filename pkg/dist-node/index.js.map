{"version":3,"file":"index.js","sources":["../dist-src/index.js"],"sourcesContent":["import { fileTemplate, pathTemplate } from \"buurman-utils\";\nimport { mkdirp, readFile, writeFile } from \"fs-extra\";\nimport { dirname, isAbsolute, join, relative } from \"path\";\nimport readdir from \"recursive-readdir\";\nexport const run = async (context, { source, variables, destination }) => {\n    destination = isAbsolute(destination)\n        ? destination\n        : join(process.cwd(), destination);\n    const processPath = pathTemplate(variables);\n    const tpl = fileTemplate(variables);\n    if (!context.path) {\n        throw new Error(`Can't run template action, no path provided in action context.`);\n    }\n    const templateRoot = join(context.path, source);\n    const files = await readdir(templateRoot);\n    for (const path of files) {\n        const dest = join(destination, relative(templateRoot, path));\n        const filePath = processPath(dest);\n        await mkdirp(dirname(filePath));\n        await writeFile(filePath, tpl(await readFile(path, \"utf-8\")));\n    }\n};\n"],"names":["run","context","source","variables","destination","isAbsolute","join","process","cwd","processPath","pathTemplate","tpl","fileTemplate","path","Error","templateRoot","files","readdir","dest","relative","filePath","mkdirp","dirname","writeFile","readFile"],"mappings":";;;;;;;;;;;MAIaA,GAAG,GAAG,OAAOC,OAAP,EAAgB;AAAEC,EAAAA,MAAF;AAAUC,EAAAA,SAAV;AAAqBC,EAAAA;AAArB,CAAhB,KAAuD;AACtEA,EAAAA,WAAW,GAAGC,eAAU,CAACD,WAAD,CAAV,GACRA,WADQ,GAERE,SAAI,CAACC,OAAO,CAACC,GAAR,EAAD,EAAgBJ,WAAhB,CAFV;AAGA,QAAMK,WAAW,GAAGC,yBAAY,CAACP,SAAD,CAAhC;AACA,QAAMQ,GAAG,GAAGC,yBAAY,CAACT,SAAD,CAAxB;;AACA,MAAI,CAACF,OAAO,CAACY,IAAb,EAAmB;AACf,UAAM,IAAIC,KAAJ,CAAW,gEAAX,CAAN;AACH;;AACD,QAAMC,YAAY,GAAGT,SAAI,CAACL,OAAO,CAACY,IAAT,EAAeX,MAAf,CAAzB;AACA,QAAMc,KAAK,GAAG,MAAMC,OAAO,CAACF,YAAD,CAA3B;;AACA,OAAK,MAAMF,MAAX,IAAmBG,KAAnB,EAA0B;AACtB,UAAME,IAAI,GAAGZ,SAAI,CAACF,WAAD,EAAce,aAAQ,CAACJ,YAAD,EAAeF,MAAf,CAAtB,CAAjB;AACA,UAAMO,QAAQ,GAAGX,WAAW,CAACS,IAAD,CAA5B;AACA,UAAMG,cAAM,CAACC,YAAO,CAACF,QAAD,CAAR,CAAZ;AACA,UAAMG,iBAAS,CAACH,QAAD,EAAWT,GAAG,EAAC,MAAMa,gBAAQ,CAACX,MAAD,EAAO,OAAP,CAAf,EAAd,CAAf;AACH;AACJ;;;;"}