{"version":3,"file":"index.js","sources":["../dist-src/index.js"],"sourcesContent":["import { fileTemplate, pathTemplate } from \"buurman-utils\";\nimport { mkdirp, readFile, writeFile } from \"fs-extra\";\nimport { dirname, isAbsolute, join, relative } from \"path\";\nimport readdir from \"recursive-readdir\";\nexport const run = async (context, { source, variables, destination }) => {\n    destination = isAbsolute(destination)\n        ? destination\n        : join(process.cwd(), destination);\n    const processPath = pathTemplate(variables);\n    const tpl = fileTemplate(variables);\n    const templateRoot = isAbsolute(source)\n        ? // source is absolute, ignore context.path\n            source\n        : // source is relative,\n            // join context.path (or cwd if not provided) with source\n            join(context.path || process.cwd(), source);\n    const files = await readdir(templateRoot);\n    for (const path of files) {\n        const dest = join(destination, relative(templateRoot, path));\n        const filePath = processPath(dest);\n        await mkdirp(dirname(filePath));\n        await writeFile(filePath, tpl(await readFile(path, \"utf-8\")));\n    }\n};\n"],"names":["run","context","source","variables","destination","isAbsolute","join","process","cwd","processPath","pathTemplate","tpl","fileTemplate","templateRoot","path","files","readdir","dest","relative","filePath","mkdirp","dirname","writeFile","readFile"],"mappings":";;;;;;;;;;;MAIaA,GAAG,GAAG,OAAOC,OAAP,EAAgB;AAAEC,EAAAA,MAAF;AAAUC,EAAAA,SAAV;AAAqBC,EAAAA;AAArB,CAAhB,KAAuD;AACtEA,EAAAA,WAAW,GAAGC,eAAU,CAACD,WAAD,CAAV,GACRA,WADQ,GAERE,SAAI,CAACC,OAAO,CAACC,GAAR,EAAD,EAAgBJ,WAAhB,CAFV;AAGA,QAAMK,WAAW,GAAGC,yBAAY,CAACP,SAAD,CAAhC;AACA,QAAMQ,GAAG,GAAGC,yBAAY,CAACT,SAAD,CAAxB;AACA,QAAMU,YAAY,GAAGR,eAAU,CAACH,MAAD,CAAV;AAEbA,EAAAA,MAFa;AAIb;AACAI,EAAAA,SAAI,CAACL,OAAO,CAACa,IAAR,IAAgBP,OAAO,CAACC,GAAR,EAAjB,EAAgCN,MAAhC,CALZ;AAMA,QAAMa,KAAK,GAAG,MAAMC,OAAO,CAACH,YAAD,CAA3B;;AACA,OAAK,MAAMC,MAAX,IAAmBC,KAAnB,EAA0B;AACtB,UAAME,IAAI,GAAGX,SAAI,CAACF,WAAD,EAAcc,aAAQ,CAACL,YAAD,EAAeC,MAAf,CAAtB,CAAjB;AACA,UAAMK,QAAQ,GAAGV,WAAW,CAACQ,IAAD,CAA5B;AACA,UAAMG,cAAM,CAACC,YAAO,CAACF,QAAD,CAAR,CAAZ;AACA,UAAMG,iBAAS,CAACH,QAAD,EAAWR,GAAG,EAAC,MAAMY,gBAAQ,CAACT,MAAD,EAAO,OAAP,CAAf,EAAd,CAAf;AACH;AACJ;;;;"}