{"version":3,"file":"index.js","sources":["../dist-src/index.js"],"sourcesContent":["import { fileTemplate, pathTemplate } from \"buurman-utils\";\nimport { mkdirp, pathExists, readFile, writeFile } from \"fs-extra\";\nimport { dirname, isAbsolute, join, relative } from \"path\";\nimport readdir from \"recursive-readdir\";\nexport const run = async (context, { source, variables, destination, overwrite }) => {\n    destination = isAbsolute(destination)\n        ? destination\n        : join(process.cwd(), destination);\n    const processPath = pathTemplate(variables);\n    const tpl = fileTemplate(variables);\n    const templateRoot = isAbsolute(source)\n        ? // source is absolute, ignore context.path\n            source\n        : // source is relative,\n            // join context.path (or cwd if not provided) with source\n            join(context.path || process.cwd(), source);\n    const files = await readdir(templateRoot);\n    for (const path of files) {\n        const dest = join(destination, relative(templateRoot, path));\n        const filePath = processPath(dest);\n        await mkdirp(dirname(filePath));\n        if (!overwrite && (await pathExists(filePath))) {\n            continue;\n        }\n        await writeFile(filePath, tpl(await readFile(path, \"utf-8\")));\n    }\n};\n"],"names":["run","context","source","variables","destination","overwrite","isAbsolute","join","process","cwd","processPath","pathTemplate","tpl","fileTemplate","templateRoot","path","files","readdir","dest","relative","filePath","mkdirp","dirname","pathExists","writeFile","readFile"],"mappings":";;;;;;;;;;;MAIaA,GAAG,GAAG,OAAOC,OAAP,EAAgB;AAAEC,EAAAA,MAAF;AAAUC,EAAAA,SAAV;AAAqBC,EAAAA,WAArB;AAAkCC,EAAAA;AAAlC,CAAhB,KAAkE;AACjFD,EAAAA,WAAW,GAAGE,eAAU,CAACF,WAAD,CAAV,GACRA,WADQ,GAERG,SAAI,CAACC,OAAO,CAACC,GAAR,EAAD,EAAgBL,WAAhB,CAFV;AAGA,QAAMM,WAAW,GAAGC,yBAAY,CAACR,SAAD,CAAhC;AACA,QAAMS,GAAG,GAAGC,yBAAY,CAACV,SAAD,CAAxB;AACA,QAAMW,YAAY,GAAGR,eAAU,CAACJ,MAAD,CAAV;AAEbA,EAAAA,MAFa;AAIb;AACAK,EAAAA,SAAI,CAACN,OAAO,CAACc,IAAR,IAAgBP,OAAO,CAACC,GAAR,EAAjB,EAAgCP,MAAhC,CALZ;AAMA,QAAMc,KAAK,GAAG,MAAMC,OAAO,CAACH,YAAD,CAA3B;;AACA,OAAK,MAAMC,MAAX,IAAmBC,KAAnB,EAA0B;AACtB,UAAME,IAAI,GAAGX,SAAI,CAACH,WAAD,EAAce,aAAQ,CAACL,YAAD,EAAeC,MAAf,CAAtB,CAAjB;AACA,UAAMK,QAAQ,GAAGV,WAAW,CAACQ,IAAD,CAA5B;AACA,UAAMG,cAAM,CAACC,YAAO,CAACF,QAAD,CAAR,CAAZ;;AACA,QAAI,CAACf,SAAD,KAAe,MAAMkB,kBAAU,CAACH,QAAD,CAA/B,CAAJ,EAAgD;AAC5C;AACH;;AACD,UAAMI,iBAAS,CAACJ,QAAD,EAAWR,GAAG,EAAC,MAAMa,gBAAQ,CAACV,MAAD,EAAO,OAAP,CAAf,EAAd,CAAf;AACH;AACJ;;;;"}